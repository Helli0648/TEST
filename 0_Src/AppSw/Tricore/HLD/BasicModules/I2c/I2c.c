/*
 * I2c.c
 *
 *  Created on: 2019. 7. 1.
 *      Author: bigbi_000
 */


/******************************************************************************/
/*----------------------------------Includes----------------------------------*/
/******************************************************************************/
#include "HLD.h"
#include "I2c.h"
/******************************************************************************/
/*-----------------------------------Macros-----------------------------------*/
/******************************************************************************/

/******************************************************************************/
/*--------------------------------Enumerations--------------------------------*/
/******************************************************************************/


/******************************************************************************/
/*-----------------------------Data Structures--------------------------------*/
/******************************************************************************/


/******************************************************************************/
/*------------------------------Global variables------------------------------*/
/******************************************************************************/


/******************************************************************************/
/*-------------------------Function Prototypes--------------------------------*/
/******************************************************************************/
//HLD_I2c_t	HLD_I2c;

/******************************************************************************/
/*------------------------Private Variables/Constants-------------------------*/
/******************************************************************************/


/******************************************************************************/
/*-------------------------Function Implementations---------------------------*/
/******************************************************************************/

void HLD_I2c_init(HLD_I2c_t *i2c ,uint8 i2cAddress, float32 baudrate)
{
    /* disable interrupts */
    boolean   interruptState = IfxCpu_disableInterrupts();

    //Ifx_SizeT size;
//     i2c->i2cAddress = i2cAddress;

     {   /* init Module */
         IfxI2c_I2c_Config config;

         IfxI2c_I2c_initConfig(&config, &MODULE_I2C0);

         const IfxI2c_Pins pins = {&IfxI2c0_SCL_P13_1_INOUT, &IfxI2c0_SDA_P13_2_INOUT, IfxPort_PadDriver_ttlSpeed1};

         config.pins     = &pins;
         config.baudrate = baudrate;

         IfxI2c_I2c_initModule(&i2c->driver.i2c, &config);
     }

     {                                                                   /* init slave devices */
         IfxI2c_I2c_deviceConfig i2cDeviceConfig;
         IfxI2c_I2c_initDeviceConfig(&i2cDeviceConfig, &i2c->driver.i2c); /* Device config for Bus of i2c handle */

         i2cDeviceConfig.deviceAddress = i2cAddress;
         IfxI2c_I2c_initDevice(&i2c->driver.i2cDevice, &i2cDeviceConfig);
     }

    /* enable interrupts again */
    IfxCpu_restoreInterrupts(interruptState);
}


